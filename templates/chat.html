<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Чат с {{ receiver.first_name }} {{ receiver.last_name }}</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
<div class="container py-5">
  <h3 class="mb-4">Чат с {{ receiver.first_name }} {{ receiver.last_name }}</h3>

  <div id="chat-box" class="border rounded p-3 mb-3 bg-white" style="height:300px; overflow-y:auto;">
    {% for msg in messages %}
      <p>
        <strong>{{ 'Вы' if msg.sender_id == session.user.id else receiver.first_name }}:</strong>
        {{ msg.text }}
      </p>
    {% endfor %}
  </div>

  <form method="POST" class="mb-3">
    <textarea name="text" class="form-control mb-2" placeholder="Сообщение..." required></textarea>
    <button class="btn btn-success">Отправить</button>
  </form>

  <a href="{{ url_for('profile') }}" class="btn btn-secondary">← Назад в профиль</a>
</div>

<!-- Скрипт автопрокрутки -->
<script>
  const chatBox = document.getElementById("chat-box");
  if (chatBox) {
    chatBox.scrollTop = chatBox.scrollHeight;
  }
</script>
</body>
</html>
